# 배합일지 완전 자동화 설정 가이드

## 🎯 목표: 원클릭 완전 자동화
구글 시트에서 "타임스템프 이동" 클릭 → 엑셀에 데이터 자동 입력

## 🚀 1단계: Python 서버 자동 시작 설정

### 방법 A: Windows 시작프로그램 등록 (추천)

1. **Win + R** → `shell:startup` 입력 → 엔터
2. **자동시작_서버.bat** 파일을 시작프로그램 폴더에 **복사**
3. **컴퓨터 재부팅** → 서버 자동 실행됨

### 방법 B: 수동 실행
**자동시작_서버.bat** 파일을 더블클릭
- Python 및 Flask 자동 설치 확인
- 웹훅 서버 localhost:5000에서 실행

## 🔧 2단계: 엑셀 파일 준비

### 엑셀 파일 생성
1. **바탕화면**에 **배합일지_데이터.xlsx** 새 파일 생성
2. **Alt + F11** → VBA 에디터 열기
3. **삽입** → **모듈** → `GoogleSheets_To_Excel.vba` 코드 추가

### VBA 매크로 보안 설정
1. **파일** → **옵션** → **보안 센터** → **보안 센터 설정**
2. **매크로 설정** → **모든 매크로 사용** 선택
3. **확인** → 엑셀 재시작

## ⚡ 3단계: 완전 자동화 실행

### 자동화 체인
```
1. 구글 시트 "타임스템프 이동" 클릭
   ↓
2. 뷰 → ERP 변환 (자동)
   ↓  
3. 웹훅 → Python 서버 (자동)
   ↓
4. VBS → 엑셀 VBA 실행 (자동)
   ↓
5. 구글 데이터 → 엑셀 입력 (자동)
```

### 실행 확인
- **Python 서버**: 백그라운드에서 계속 실행 중
- **구글 시트**: 클릭 한 번으로 모든 과정 자동 실행
- **엑셀**: 자동으로 열리고 데이터 입력됨

## 🛠️ 4단계: 문제 해결

### Python 서버가 실행되지 않을 때
1. **작업 관리자**에서 `python.exe` 프로세스 확인
2. **자동시작_서버.bat** 다시 실행
3. **포트 충돌** 확인: `netstat -an | findstr :5000`

### 웹훅 연결 실패 시
1. **방화벽** 설정 확인 (localhost 허용)
2. **Python 서버 로그** 확인: `webhook.log` 파일
3. **수동 테스트**: 브라우저에서 `http://localhost:5000` 접속

## 💡 추가 자동화 옵션

### 옵션 1: Windows 작업 스케줄러
- **정해진 시간**에 자동 실행
- **주기적 업데이트** (매일 오전 9시 등)

### 옵션 2: 바탕화면 바로가기
```
대상: "자동시작_서버.bat"
시작 위치: "C:\Users\미쓰리\Desktop\깃허브\New-repository\배합일지"
```

### 옵션 3: 백그라운드 서비스
Python 서버를 Windows 서비스로 등록 (고급 사용자용)

## 🎉 최종 결과

**한 번 설정 후**:
- 컴퓨터 부팅 시 Python 서버 자동 실행
- 구글 시트에서 클릭 한 번으로 엑셀까지 완전 자동화
- Y:\ 드라이브 없이도 바탕화면에서 모든 작업 완료

**자동시작_서버.bat** 파일을 실행해서 서버를 먼저 시작해보세요!