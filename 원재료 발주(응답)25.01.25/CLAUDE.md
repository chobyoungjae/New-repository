# CLAUDE.md

이 파일은 이 저장소의 코드를 작업할 때 Claude Code (claude.ai/code)에게 가이드를 제공합니다.

## 프로젝트 개요

Google Apps Script를 사용한 원재료 발주 관리 시스템입니다. 스프레드시트와 Google 캘린더를 연동하여 발주 내역을 자동으로 관리합니다.

## 주요 기능 및 파일 구조

### 핵심 스크립트 파일들:
- `구매캘린더로 전송.js`: 메인 트리거 함수 - 발주완료 시 구매 캘린더로 데이터 이동
- `스프레드시트_to_캘린더.js`: 스프레드시트 데이터를 Google 캘린더로 동기화
- `캘린더_to_스프레드시트.js`: Google 캘린더 정보를 스프레드시트로 역동기화
- `카톡 메시지 보내기.js`: 카카오톡 알림 기능 (현재 활성)
- `카톡 메시지 보내기 (현재 주석처리).js`: 카카오톡 알림 기능 (비활성 버전)

### 스프레드시트 구조:
- **시트 A**: 부재료(박스)
- **시트 B**: 부재료(포장지)  
- **시트 C**: 원재료
- **시트 D**: 구매 캘린더
- **해당거래처 시트**: 거래처별 결제 조건 관리

### 트리거 로직:
- N열(14번째 열)에 "발주완료" 입력 시 `moveToBuyCalendar()` 함수 자동 실행
- 해당 행 데이터가 구매 캘린더 시트로 자동 이동
- 거래처 조건에 따라 L열에 체크박스 자동 생성

## 색상 매핑 시스템

```javascript
const colorMap = {
  파랑: 1, 초록: 2, 보라: 3, 핑크: 4, 노랑: 5,
  청록: 6, 모르는색: 7, 회색: 8, 진한초록: 9,
  진한빨강: 10, 빨강: 11
};
```

## 캘린더 설정

- 캘린더 ID: `u37tatg5kaj7q6eru6m2o9vr80@group.calendar.google.com`
- 타임존: `Asia/Seoul`
- 런타임: V8

## 중요한 데이터 흐름

1. **발주 완료 처리**: A,B,C 시트 → D 시트 (구매 캘린더)
2. **캘린더 동기화**: 스프레드시트 ↔ Google 캘린더
3. **알림 발송**: 카카오톡 메시지 (선택적)

## 알려진 이슈

현재 연속으로 3-4개 행을 빠르게 "발주완료"로 변경할 때 일부 데이터가 구매 캘린더로 이동하지 않는 문제가 있습니다. 이는 Google Apps Script의 트리거 처리 속도 및 동시성 문제로 추정됩니다.

## 개발 시 주의사항

- 모든 날짜는 `Asia/Seoul` 타임존 기준
- 트리거 함수 수정 시 Google Apps Script 트리거 재설정 필요
- 색상 변경 시 캘린더 API 제한사항 고려
- 스프레드시트 구조 변경 시 열 번호 하드코딩 부분 수정 필요